<!DOCTYPE html><!DOCTYPE html>

<html lang="en"><html lang="en">

<head><head>

    <meta charset="UTF-8">    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Kraken AI Trading Bot v2.0</title>    <meta name="description" content="AI-powered Kraken trading bot with real-time price updates and paper trading">

    <style>    <title>Kraken AI Trading Bot</title>

        * { margin: 0; padding: 0; box-sizing: border-box; }    <link rel="stylesheet" href="styles.css">

        </head>

        body {<body>

            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;    <div class="container">

            background: #0f0f1a;        <header>

            color: #e0e0e0;            <h1>üöÄ Kraken AI Trading Bot</h1>

            min-height: 100vh;            <p>High-frequency volatility scraper and mean reversion trader</p>

        }

                    <!-- Header Stats -->

        .container {            <div class="stats-bar">

            max-width: 1600px;                <div class="stat-item">

            margin: 0 auto;                    <span class="stat-label">Bankroll:</span>

            padding: 20px;                    <span class="stat-value" id="bankroll">$1,000</span>

        }                </div>

                        <div class="stat-item">

        /* Header */                    <span class="stat-label">Total P&L:</span>

        header {                    <span class="stat-value" id="total-pnl">$0</span>

            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);                </div>

            border-radius: 16px;                <div class="stat-item">

            padding: 24px;                    <span class="stat-label">Win Rate:</span>

            margin-bottom: 20px;                    <span class="stat-value" id="win-rate">0%</span>

            border: 1px solid #2d3a4f;                </div>

        }                <div class="stat-item">

                            <span class="stat-label">Trades:</span>

        header h1 {                    <span class="stat-value" id="trade-count">0</span>

            font-size: 28px;                </div>

            color: #00d4aa;            </div>

            margin-bottom: 8px;        </header>

            display: flex;

            align-items: center;        <!-- Bot Status Panel -->

            gap: 10px;        <div class="bot-status-panel">

        }            <h2>ü§ñ Bot Status</h2>

                    <div class="bot-status-content">

        header p {                <div class="bot-status-item">

            color: #8892a0;                    <span class="status-label">Status:</span>

            font-size: 14px;                    <span class="status-value" id="bot-status">üî¥ Offline</span>

        }                </div>

                        <div class="bot-status-item">

        /* Main Grid */                    <span class="status-label">Mode:</span>

        .main-grid {                    <span class="status-value" id="bot-mode">Unknown</span>

            display: grid;                </div>

            grid-template-columns: 1fr 1fr 1fr;                <div class="bot-status-item">

            gap: 20px;                    <span class="status-label">Pairs Scanned:</span>

            margin-bottom: 20px;                    <span class="status-value" id="pairs-scanned">0</span>

        }                </div>

                        <div class="bot-status-item">

        @media (max-width: 1200px) {                    <span class="status-label">Trades Completed:</span>

            .main-grid { grid-template-columns: 1fr 1fr; }                    <span class="status-value" id="trades-completed">0</span>

        }                </div>

                        <div class="bot-status-item">

        @media (max-width: 800px) {                    <span class="status-label">Current P&L:</span>

            .main-grid { grid-template-columns: 1fr; }                    <span class="status-value" id="current-pnl">$0.00</span>

        }                </div>

                        <div class="bot-activity" id="bot-activity">Waiting for bot status...</div>

        /* Cards */            </div>

        .card {            <div class="bot-controls">

            background: #1a1a2e;                <button id="start-bot" class="btn-primary">‚ñ∂Ô∏è Start Bot</button>

            border-radius: 12px;                <button id="stop-bot" class="btn-secondary" disabled>‚èπÔ∏è Stop Bot</button>

            padding: 20px;                <button id="show-settings" class="btn-secondary">‚öôÔ∏è Settings</button>

            border: 1px solid #2d3a4f;            </div>

        }        </div>

        

        .card h2 {        <!-- Learning Dashboard -->

            font-size: 16px;        <div class="learning-dashboard">

            color: #8892a0;            <h2>üß† AI Learning Dashboard</h2>

            margin-bottom: 16px;            <div class="learning-grid">

            display: flex;                <div class="learning-card">

            align-items: center;                    <h3>üìä Performance Metrics</h3>

            gap: 8px;                    <div class="metric-row">

        }                        <span class="metric-label">Total Trades:</span>

                                <span class="metric-value" id="learning-total-trades">0</span>

        /* Bot Status */                    </div>

        .status-indicator {                    <div class="metric-row">

            display: inline-flex;                        <span class="metric-label">Win Rate:</span>

            align-items: center;                        <span class="metric-value" id="learning-win-rate">0.0%</span>

            gap: 8px;                    </div>

            padding: 6px 14px;                    <div class="metric-row">

            border-radius: 20px;                        <span class="metric-label">Total P&L:</span>

            font-size: 14px;                        <span class="metric-value" id="learning-total-pnl">$0.00</span>

            font-weight: 600;                    </div>

        }                </div>

                        <div class="learning-card">

        .status-indicator.running {                    <h3>üîß Adaptive Parameters</h3>

            background: rgba(0, 212, 170, 0.15);                    <div class="metric-row">

            color: #00d4aa;                        <span class="metric-label">Position Size:</span>

        }                        <span class="metric-value" id="learning-position-size">$100.00</span>

                            </div>

        .status-indicator.stopped {                    <div class="metric-row">

            background: rgba(255, 107, 107, 0.15);                        <span class="metric-label">Target Leverage:</span>

            color: #ff6b6b;                        <span class="metric-value" id="learning-leverage">2.00x</span>

        }                    </div>

                            <div class="param-bar-container">

        .status-dot {                        <div class="param-bar" id="position-bar" style="width: 100%"></div>

            width: 8px;                    </div>

            height: 8px;                </div>

            border-radius: 50%;            </div>

            animation: pulse 2s infinite;            <div class="recent-trades-section">

        }                <h3>üìú Recent Trades</h3>

                        <div class="trades-list" id="recent-trades-list">

        .status-indicator.running .status-dot { background: #00d4aa; }                    <div class="trade-item empty">No trades recorded yet...</div>

        .status-indicator.stopped .status-dot { background: #ff6b6b; animation: none; }                </div>

                    </div>

        @keyframes pulse {        </div>

            0%, 100% { opacity: 1; }

            50% { opacity: 0.5; }        <!-- Settings Panel -->

        }        <div class="settings-panel" id="settings-panel" style="display: none;">

                    <h2>‚öôÔ∏è Trading Configuration</h2>

        /* Big Numbers */            <div class="settings-group">

        .big-number {                <label for="groq-api-key">

            font-size: 36px;                    <strong>Groq API Key</strong>

            font-weight: 700;                    <input type="password" id="groq-api-key" placeholder="Enter your Groq API key">

            margin: 8px 0;                </label>

        }                <button id="save-api-key" class="btn-secondary">Save API Key</button>

                    </div>

        .big-number.positive { color: #00d4aa; }            <div class="settings-group">

        .big-number.negative { color: #ff6b6b; }                <label for="ai-threshold">

        .big-number.neutral { color: #e0e0e0; }                    <strong>AI Confidence Threshold:</strong>

                            <input type="range" id="ai-threshold" min="0.1" max="0.9" step="0.1" value="0.7">

        .sub-text {                    <span id="ai-threshold-value">0.7</span>

            font-size: 13px;                </label>

            color: #6b7280;            </div>

        }            <div class="settings-group">

                        <label for="timer-duration">

        /* Stats Grid */                    <strong>Trade Timer (seconds):</strong>

        .stats-grid {                    <input type="number" id="timer-duration" min="10" max="300" value="60">

            display: grid;                </label>

            grid-template-columns: repeat(2, 1fr);            </div>

            gap: 16px;            <div class="settings-group">

        }                <label for="realistic-mode">

                            <input type="checkbox" id="realistic-mode">

        .stat-item {                    <strong>Realistic Mode</strong> - Enable fees & slippage

            background: #12121f;                </label>

            padding: 14px;            </div>

            border-radius: 8px;            <div class="settings-group">

        }                <label for="ai-bias">

                            <input type="checkbox" id="ai-bias" checked>

        .stat-label {                    <strong>AI Confidence Bias</strong> - High-confidence trades trend upward

            font-size: 12px;                </label>

            color: #6b7280;                <p class="settings-hint">Disable for random market simulation (harder).</p>

            text-transform: uppercase;            </div>

            letter-spacing: 0.5px;            <button id="close-settings">Close Settings</button>

            margin-bottom: 4px;        </div>

        }

                <!-- Risk Warning Banner -->

        .stat-value {        <div class="risk-warning" id="risk-warning">

            font-size: 20px;            <div class="risk-warning-content">

            font-weight: 600;                <span class="warning-icon">‚ö†Ô∏è</span>

            color: #e0e0e0;                <div class="warning-text">

        }                    <strong>PAPER TRADING MODE</strong> - No real money at risk

                            <br>

        .stat-value.positive { color: #00d4aa; }                    <small id="price-source-indicator">Price source: <span id="price-source-label">Checking...</span></small>

        .stat-value.negative { color: #ff6b6b; }                </div>

                        <button id="check-live-readiness" class="btn-small">Check Live Readiness</button>

        /* Progress Bars */            </div>

        .progress-container {        </div>

            margin: 16px 0;

        }        <!-- Live Readiness Modal -->

                <div class="modal" id="readiness-modal">

        .progress-label {            <div class="modal-content">

            display: flex;                <h2>üìä Live Trading Readiness Check</h2>

            justify-content: space-between;                <div id="readiness-results"></div>

            font-size: 12px;                <button id="close-readiness-modal" class="btn-secondary">Close</button>

            margin-bottom: 6px;            </div>

        }        </div>

        

        .progress-bar {        <!-- Status Message -->

            height: 8px;        <div class="status-message" id="status-message"></div>

            background: #12121f;

            border-radius: 4px;        <!-- Active Trade Panel -->

            overflow: hidden;        <div class="active-trade-panel" id="active-trade-panel" style="display: none;">

        }            <h3>üéØ Active Trade</h3>

                    <div class="trade-info">

        .progress-fill {                <div class="trade-row">

            height: 100%;                    <span class="trade-label">Question:</span>

            border-radius: 4px;                    <span class="trade-value" id="trade-question">Loading...</span>

            transition: width 0.5s ease;                </div>

        }                <div class="trade-row">

                            <span class="trade-label">Entry Price:</span>

        .progress-fill.green { background: linear-gradient(90deg, #00d4aa, #00ff88); }                    <span class="trade-value" id="entry-price">$0.00</span>

        .progress-fill.red { background: linear-gradient(90deg, #ff6b6b, #ff4444); }                </div>

        .progress-fill.blue { background: linear-gradient(90deg, #4dabf7, #228be6); }                <div class="trade-row">

                            <span class="trade-label">Current Price:</span>

        /* Exit Breakdown */                    <span class="trade-value" id="current-price">$0.00</span>

        .exit-breakdown {                </div>

            display: flex;                <div class="trade-row">

            gap: 8px;                    <span class="trade-label">Position Size:</span>

            flex-wrap: wrap;                    <span class="trade-value" id="position-size">$100</span>

            margin-top: 12px;                </div>

        }                <div class="trade-row">

                            <span class="trade-label">P&L:</span>

        .exit-tag {                    <span class="trade-value" id="pnl-display">$0.00</span>

            padding: 6px 12px;                </div>

            border-radius: 6px;                <div class="trade-row">

            font-size: 12px;                    <span class="trade-label">Time Left:</span>

            font-weight: 500;                    <span class="trade-value" id="timer-display">60s</span>

        }                </div>

                        <div class="trade-row">

        .exit-tag.tp { background: rgba(0, 212, 170, 0.2); color: #00d4aa; }                    <span class="trade-label">Momentum:</span>

        .exit-tag.sl { background: rgba(255, 107, 107, 0.2); color: #ff6b6b; }                    <span class="trade-value" id="momentum-indicator">Neutral</span>

        .exit-tag.trail { background: rgba(77, 171, 247, 0.2); color: #4dabf7; }                </div>

        .exit-tag.timeout { background: rgba(134, 142, 150, 0.2); color: #868e96; }                <div class="trade-row">

                            <span class="trade-label">Take Profit:</span>

        /* Recent Trades */                    <span class="trade-value" id="take-profit-target">$0.00</span>

        .trades-list {                </div>

            max-height: 400px;                <div class="trade-row">

            overflow-y: auto;                    <span class="trade-label">Stop Loss:</span>

        }                    <span class="trade-value" id="stop-loss-target">$0.00</span>

                        </div>

        .trade-item {            </div>

            display: flex;            <div class="trade-controls">

            justify-content: space-between;                <button id="start-trade" class="btn-primary">Start Trade</button>

            align-items: center;                <button id="sell-now" class="btn-warning">Sell Now</button>

            padding: 12px;                <button id="close-trade" class="btn-secondary">Close Trade</button>

            background: #12121f;            </div>

            border-radius: 8px;        </div>

            margin-bottom: 8px;

        }        <!-- Market Grid -->

                <div class="market-grid" id="market-grid">

        .trade-pair {            <div class="loading">Loading markets...</div>

            font-weight: 600;        </div>

            color: #e0e0e0;

        }        <!-- Session Report -->

                <div class="session-report" id="session-report" style="display: none;">

        .trade-direction {            <h3>üìä Session Report</h3>

            font-size: 11px;            <div class="report-stats">

            padding: 2px 6px;                <div class="report-item">

            border-radius: 4px;                    <span class="report-label">Total P&L:</span>

            margin-left: 8px;                    <span class="report-value" id="report-pnl">$0</span>

        }                </div>

                        <div class="report-item">

        .trade-direction.long { background: rgba(0, 212, 170, 0.2); color: #00d4aa; }                    <span class="report-label">Win Rate:</span>

        .trade-direction.short { background: rgba(255, 107, 107, 0.2); color: #ff6b6b; }                    <span class="report-value" id="report-win-rate">0%</span>

                        </div>

        .trade-result {                <div class="report-item">

            font-weight: 600;                    <span class="report-label">Total Trades:</span>

            font-size: 14px;                    <span class="report-value" id="report-trades">0</span>

        }                </div>

                        <div class="report-item">

        .trade-result.win { color: #00d4aa; }                    <span class="report-label">Best Trade:</span>

        .trade-result.loss { color: #ff6b6b; }                    <span class="report-value" id="report-best">$0</span>

        .trade-result.pending { color: #ffd43b; }                </div>

                        <div class="report-item">

        .trade-time {                    <span class="report-label">Worst Trade:</span>

            font-size: 11px;                    <span class="report-value" id="report-worst">$0</span>

            color: #6b7280;                </div>

        }            </div>

                    <div class="trade-history">

        /* Buttons */                <h4>Trade History</h4>

        .btn {                <ul id="trade-history-list"></ul>

            padding: 12px 24px;            </div>

            border: none;            <button id="new-session" class="btn-primary">Start New Session</button>

            border-radius: 8px;        </div>

            font-size: 14px;    </div>

            font-weight: 600;        <div class="active-trade-panel" id="active-trade-panel">

            cursor: pointer;            <div class="trade-header">

            transition: all 0.2s;                <h3 id="trade-question">Market Question</h3>

            display: inline-flex;                <button id="close-trade" class="close-btn">‚úï</button>

            align-items: center;            </div>

            gap: 8px;            <div class="trade-info">

        }                <div class="info-row">

                            <span class="label">Entry Price:</span>

        .btn-primary {                    <span class="value" id="entry-price">$0.00</span>

            background: linear-gradient(135deg, #00d4aa 0%, #00b894 100%);                </div>

            color: #0f0f1a;                <div class="info-row">

        }                    <span class="label">Current Price:</span>

                            <span class="value" id="current-price">$0.00</span>

        .btn-primary:hover {                </div>

            transform: translateY(-2px);                <div class="info-row">

            box-shadow: 0 4px 12px rgba(0, 212, 170, 0.3);                    <span class="label">Position Size:</span>

        }                    <span class="value" id="position-size">0 shares</span>

                        </div>

        .btn-danger {                <div class="info-row">

            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a5a 100%);                    <span class="label">Momentum:</span>

            color: white;                    <span class="value" id="momentum-indicator">‚è∏Ô∏è Neutral</span>

        }                </div>

                    </div>

        .btn-danger:hover {            <div class="pnl-display" id="pnl-display">$0.00</div>

            transform: translateY(-2px);            <div class="trade-targets" id="trade-targets">

            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);                <span class="target-label">üéØ TP: <span id="take-profit-target">+$0</span></span>

        }                <span class="target-label">‚õî SL: <span id="stop-loss-target">-$0</span></span>

                    </div>

        .btn:disabled {            <div class="timer-display" id="timer-display">20s</div>

            opacity: 0.5;            <div class="trade-controls">

            cursor: not-allowed;                <button id="start-trade" class="btn-start">Start Trade <span class="shortcut-hint">Enter</span></button>

            transform: none !important;                <button id="sell-now" class="btn-sell">Sell Now <span class="shortcut-hint">Space</span></button>

        }            </div>

                </div>

        .controls {

            display: flex;        <!-- Session Report -->

            gap: 12px;        <div class="session-report" id="session-report">

            margin-top: 16px;            <h2>üìä Session Report</h2>

        }            <div class="report-stats">

                        <div class="report-stat">

        /* Learning Insights */                    <span class="label">Total P&L:</span>

        .insight-item {                    <span class="value" id="report-pnl">$0.00</span>

            background: #12121f;                </div>

            padding: 12px;                <div class="report-stat">

            border-radius: 8px;                    <span class="label">Win Rate:</span>

            margin-bottom: 8px;                    <span class="value" id="report-win-rate">0%</span>

            border-left: 3px solid #4dabf7;                </div>

        }                <div class="report-stat">

                            <span class="label">Total Trades:</span>

        .insight-title {                    <span class="value" id="report-trades">0</span>

            font-size: 13px;                </div>

            font-weight: 600;                <div class="report-stat">

            color: #e0e0e0;                    <span class="label">Best Trade:</span>

            margin-bottom: 4px;                    <span class="value" id="report-best">$0.00</span>

        }                </div>

                        <div class="report-stat">

        .insight-text {                    <span class="label">Worst Trade:</span>

            font-size: 12px;                    <span class="value" id="report-worst">$0.00</span>

            color: #8892a0;                </div>

        }            </div>

                    <div class="trade-history">

        /* Strategy Display */                <h3>Trade History</h3>

        .strategy-params {                <div id="trade-history-list"></div>

            display: grid;            </div>

            grid-template-columns: repeat(2, 1fr);            <button id="new-session" class="btn-primary">Start New Session</button>

            gap: 12px;        </div>

            margin-top: 12px;    </div>

        }

            <script src="config.js"></script>

        .param-item {    <script src="api.js"></script>

            background: #12121f;    <script src="save-logs.js"></script>

            padding: 10px;    <script src="game.js"></script>

            border-radius: 6px;</body>

        }</html>

        
        .param-label {
            font-size: 11px;
            color: #6b7280;
        }
        
        .param-value {
            font-size: 16px;
            font-weight: 600;
            color: #4dabf7;
        }
        
        /* Full Width Section */
        .full-width {
            grid-column: 1 / -1;
        }
        
        /* Activity Log */
        .activity-log {
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 12px;
            background: #0a0a12;
            padding: 16px;
            border-radius: 8px;
            max-height: 200px;
            overflow-y: auto;
            color: #8892a0;
        }
        
        .log-entry {
            margin-bottom: 4px;
        }
        
        .log-time {
            color: #4dabf7;
        }
        
        /* Warning Banner */
        .warning-banner {
            background: linear-gradient(135deg, rgba(255, 212, 59, 0.1) 0%, rgba(255, 169, 77, 0.1) 100%);
            border: 1px solid rgba(255, 212, 59, 0.3);
            border-radius: 8px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .warning-banner span {
            color: #ffd43b;
            font-size: 14px;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #12121f;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #2d3a4f;
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #3d4a5f;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1>ü§ñ Kraken AI Trading Bot <span style="font-size: 14px; color: #4dabf7;">v2.0</span></h1>
            <p>Momentum-based trading with adaptive learning ‚Ä¢ Real-time TP/SL/Trailing stops</p>
        </header>
        
        <!-- Warning Banner -->
        <div class="warning-banner" id="mode-banner">
            <span>‚ö†Ô∏è</span>
            <span><strong>PAPER TRADING MODE</strong> - No real money at risk. Connect wallet when confident.</span>
        </div>
        
        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Bot Status Card -->
            <div class="card">
                <h2>üì° Bot Status</h2>
                <div id="status-indicator" class="status-indicator stopped">
                    <div class="status-dot"></div>
                    <span id="status-text">Offline</span>
                </div>
                <p id="status-message" class="sub-text" style="margin-top: 12px;">Bot not started</p>
                <div class="stats-grid" style="margin-top: 16px;">
                    <div class="stat-item">
                        <div class="stat-label">Pairs Scanned</div>
                        <div class="stat-value" id="pairs-scanned">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Trades Today</div>
                        <div class="stat-value" id="trades-completed">0</div>
                    </div>
                </div>
                <div class="controls">
                    <button class="btn btn-primary" id="start-btn" onclick="startBot()">‚ñ∂Ô∏è Start Bot</button>
                    <button class="btn btn-danger" id="stop-btn" onclick="stopBot()" disabled>‚èπÔ∏è Stop Bot</button>
                </div>
            </div>
            
            <!-- P&L Card -->
            <div class="card">
                <h2>üí∞ Performance</h2>
                <div class="big-number neutral" id="total-pnl">$0.00</div>
                <p class="sub-text">Total Profit/Loss</p>
                <div class="stats-grid" style="margin-top: 16px;">
                    <div class="stat-item">
                        <div class="stat-label">Best Trade</div>
                        <div class="stat-value positive" id="best-trade">$0.00</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Worst Trade</div>
                        <div class="stat-value negative" id="worst-trade">$0.00</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Avg Win</div>
                        <div class="stat-value positive" id="avg-win">$0.00</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Avg Loss</div>
                        <div class="stat-value negative" id="avg-loss">$0.00</div>
                    </div>
                </div>
            </div>
            
            <!-- Win Rate Card -->
            <div class="card">
                <h2>üìä Win Rate</h2>
                <div class="big-number neutral" id="win-rate-display">0%</div>
                <div class="progress-container">
                    <div class="progress-label">
                        <span id="wins-count">0 wins</span>
                        <span id="losses-count">0 losses</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill green" id="win-rate-bar" style="width: 0%"></div>
                    </div>
                </div>
                <div class="stats-grid" style="margin-top: 16px;">
                    <div class="stat-item">
                        <div class="stat-label">Profit Factor</div>
                        <div class="stat-value" id="profit-factor">1.00</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Blacklisted</div>
                        <div class="stat-value" id="blacklisted">0 pairs</div>
                    </div>
                </div>
            </div>
            
            <!-- Exit Analysis Card -->
            <div class="card">
                <h2>üéØ Exit Analysis</h2>
                <p class="sub-text">How trades are closing</p>
                <div class="exit-breakdown" id="exit-breakdown">
                    <div class="exit-tag tp">üéâ TP: <span id="tp-count">0</span></div>
                    <div class="exit-tag sl">‚õî SL: <span id="sl-count">0</span></div>
                    <div class="exit-tag trail">üìà Trail: <span id="trail-count">0</span></div>
                    <div class="exit-tag timeout">‚è±Ô∏è Timeout: <span id="timeout-count">0</span></div>
                </div>
                <div class="progress-container" style="margin-top: 20px;">
                    <div class="progress-label">
                        <span>Take Profit Rate</span>
                        <span id="tp-rate">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill green" id="tp-bar" style="width: 0%"></div>
                    </div>
                </div>
                <div class="progress-container">
                    <div class="progress-label">
                        <span>Stop Loss Rate</span>
                        <span id="sl-rate">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill red" id="sl-bar" style="width: 0%"></div>
                    </div>
                </div>
            </div>
            
            <!-- Strategy Card -->
            <div class="card">
                <h2>‚öôÔ∏è Current Strategy</h2>
                <div class="strategy-params">
                    <div class="param-item">
                        <div class="param-label">Position Size</div>
                        <div class="param-value" id="position-size">$100</div>
                    </div>
                    <div class="param-item">
                        <div class="param-label">Hold Time</div>
                        <div class="param-value">3-30 min</div>
                    </div>
                    <div class="param-item">
                        <div class="param-label">Take Profit</div>
                        <div class="param-value">1.5%</div>
                    </div>
                    <div class="param-item">
                        <div class="param-label">Stop Loss</div>
                        <div class="param-value">0.5%</div>
                    </div>
                    <div class="param-item">
                        <div class="param-label">Min Volatility</div>
                        <div class="param-value">2%</div>
                    </div>
                    <div class="param-item">
                        <div class="param-label">Max Spread</div>
                        <div class="param-value">0.15%</div>
                    </div>
                </div>
            </div>
            
            <!-- Learning Insights Card -->
            <div class="card">
                <h2>üß† Learning Insights</h2>
                <div id="insights-container">
                    <div class="insight-item">
                        <div class="insight-title">Momentum Strategy</div>
                        <div class="insight-text">Following 24h trends with 0.5%+ momentum threshold</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-title">Risk Management</div>
                        <div class="insight-text">3:1 risk/reward ratio with trailing stops at 0.8% profit</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-title">Pair Filtering</div>
                        <div class="insight-text">Auto-blacklisting pairs with 3+ consecutive losses</div>
                    </div>
                </div>
            </div>
            
            <!-- Recent Trades Card -->
            <div class="card full-width">
                <h2>üìú Recent Trades</h2>
                <div class="trades-list" id="trades-list">
                    <div class="trade-item" style="justify-content: center; color: #6b7280;">
                        No trades yet. Start the bot to begin trading.
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // State
        let botRunning = false;
        
        // Format currency
        function formatCurrency(val) {
            const num = parseFloat(val) || 0;
            const sign = num >= 0 ? '' : '-';
            return sign + '$' + Math.abs(num).toFixed(2);
        }
        
        // Format time ago
        function timeAgo(timestamp) {
            const seconds = Math.floor((Date.now() - timestamp) / 1000);
            if (seconds < 60) return seconds + 's ago';
            if (seconds < 3600) return Math.floor(seconds / 60) + 'm ago';
            return Math.floor(seconds / 3600) + 'h ago';
        }
        
        // Update UI with data
        function updateUI(status, learning) {
            // Debug logging for data processing
            console.log('üìä Updating UI with P&L:', learning.total_pnl, 'Trades:', learning.total_trades, 'Win Rate:', learning.win_rate);
            
            // Bot status with existence checks
            const indicator = document.getElementById('status-indicator');
            const statusText = document.getElementById('status-text');
            const statusMsg = document.getElementById('status-message');
            
            if (indicator && statusText && statusMsg) {
                if (status.running) {
                    indicator.className = 'status-indicator running';
                    statusText.textContent = 'Running';
                    const startBtn = document.getElementById('start-btn');
                    const stopBtn = document.getElementById('stop-btn');
                    if (startBtn) startBtn.disabled = true;
                    if (stopBtn) stopBtn.disabled = false;
                } else {
                    indicator.className = 'status-indicator stopped';
                    statusText.textContent = 'Offline';
                    const startBtn = document.getElementById('start-btn');
                    const stopBtn = document.getElementById('stop-btn');
                    if (startBtn) startBtn.disabled = false;
                    if (stopBtn) stopBtn.disabled = true;
                }
                
                statusMsg.textContent = status.message || 'Waiting...';
            }
            
            const pairsScannedEl = document.getElementById('pairs-scanned');
            if (pairsScannedEl) pairsScannedEl.textContent = status.pairs_scanned || 0;
            
            const tradesCompletedEl = document.getElementById('trades-completed');
            if (tradesCompletedEl) tradesCompletedEl.textContent = status.trades_completed || 0;
            
            // P&L with existence checks
            const pnl = learning.total_pnl || 0;
            const pnlEl = document.getElementById('total-pnl');
            if (pnlEl) {
                pnlEl.textContent = formatCurrency(pnl);
                pnlEl.className = 'big-number ' + (pnl > 0 ? 'positive' : pnl < 0 ? 'negative' : 'neutral');
            }
            
            const bestTradeEl = document.getElementById('best-trade');
            if (bestTradeEl) bestTradeEl.textContent = formatCurrency(learning.best_trade || 0);
            
            const worstTradeEl = document.getElementById('worst-trade');
            if (worstTradeEl) worstTradeEl.textContent = formatCurrency(learning.worst_trade || 0);
            
            const avgWinEl = document.getElementById('avg-win');
            if (avgWinEl) avgWinEl.textContent = formatCurrency(learning.avg_win || 0);
            
            const avgLossEl = document.getElementById('avg-loss');
            if (avgLossEl) avgLossEl.textContent = formatCurrency(learning.avg_loss || 0);
            
            // Win rate with existence checks
            const wr = learning.win_rate || 0;
            const wrEl = document.getElementById('win-rate-display');
            if (wrEl) {
                wrEl.textContent = wr.toFixed(1) + '%';
                wrEl.className = 'big-number ' + (wr >= 50 ? 'positive' : wr > 0 ? 'negative' : 'neutral');
            }
            
            const wrBarEl = document.getElementById('win-rate-bar');
            if (wrBarEl) wrBarEl.style.width = wr + '%';
            
            const winsCountEl = document.getElementById('wins-count');
            if (winsCountEl) winsCountEl.textContent = (learning.winning_trades || 0) + ' wins';
            
            const lossesCountEl = document.getElementById('losses-count');
            if (lossesCountEl) lossesCountEl.textContent = (learning.losing_trades || 0) + ' losses';
            
            const pf = learning.profit_factor || 1;
            const pfEl = document.getElementById('profit-factor');
            if (pfEl) {
                pfEl.textContent = pf.toFixed(2);
                pfEl.className = 'stat-value ' + (pf >= 1 ? 'positive' : 'negative');
            }
            
            const blacklistedEl = document.getElementById('blacklisted');
            if (blacklistedEl) blacklistedEl.textContent = (learning.blacklisted_pairs || 0) + ' pairs';
            
            // Exit breakdown
            const tp = learning.tp_exits || 0;
            const sl = learning.sl_exits || 0;
            const trail = learning.trailing_exits || 0;
            const timeout = learning.timeout_exits || 0;
            const total = tp + sl + trail + timeout || 1;
            
            document.getElementById('tp-count').textContent = tp;
            document.getElementById('sl-count').textContent = sl;
            document.getElementById('trail-count').textContent = trail;
            document.getElementById('timeout-count').textContent = timeout;
            
            const tpRate = (tp / total * 100);
            const slRate = (sl / total * 100);
            document.getElementById('tp-rate').textContent = tpRate.toFixed(0) + '%';
            document.getElementById('sl-rate').textContent = slRate.toFixed(0) + '%';
            document.getElementById('tp-bar').style.width = tpRate + '%';
            document.getElementById('sl-bar').style.width = slRate + '%';
            
            // Recent trades
            const trades = learning.recent_trades || [];
            const tradesList = document.getElementById('trades-list');
            
            if (trades.length > 0) {
                tradesList.innerHTML = trades.slice(0, 20).map(t => {
                    const dirClass = t.direction === 'LONG' ? 'long' : 'short';
                    let resultClass = 'pending';
                    let resultText = '‚è≥ Active';
                    
                    if (t.status === 'completed' && t.result) {
                        if (t.result === 'take_profit' || t.result === 'trailing_stop') {
                            resultClass = 'win';
                            resultText = '‚úÖ ' + t.result.replace(/_/g, ' ');
                        } else {
                            resultClass = 'loss';
                            resultText = '‚ùå ' + t.result.replace(/_/g, ' ');
                        }
                    } else if (t.exit_reason) {
                        if (t.exit_reason === 'take_profit' || t.exit_reason === 'trailing_stop') {
                            resultClass = 'win';
                            resultText = '‚úÖ ' + t.exit_reason.replace(/_/g, ' ');
                        } else {
                            resultClass = 'loss';
                            resultText = '‚ùå ' + t.exit_reason.replace(/_/g, ' ');
                        }
                    } else if (t.status === 'exiting') {
                        resultText = '‚è≥ Exiting...';
                    }
                    
                    return `
                        <div class="trade-item">
                            <div>
                                <span class="trade-pair">${t.pair}</span>
                                <span class="trade-direction ${dirClass}">${t.direction}</span>
                            </div>
                            <div style="text-align: right;">
                                <div class="trade-result ${resultClass}">${resultText}</div>
                                <div class="trade-time">${timeAgo(t.timestamp)}</div>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        }
        
        // Fetch data
        async function fetchData() {
            try {
                const [statusRes, learningRes] = await Promise.all([
                    fetch('/api/bot/status'),
                    fetch('/api/bot/learning')
                ]);
                
                const status = await statusRes.json();
                const learning = await learningRes.json();
                
                // ADD THIS: Debug logging to console
                console.log('üîÑ UI Update - Bot Status:', status);
                console.log('üîÑ UI Update - Learning Data:', learning);
                
                updateUI(status, learning);
            } catch (err) {
                console.error('‚ùå Fetch error:', err);
            }
        }
        
        // Start bot
        async function startBot() {
            try {
                const res = await fetch('/api/bot/start', { method: 'POST' });
                const data = await res.json();
                if (data.success) {
                    console.log('Bot started');
                } else {
                    alert('Failed to start: ' + (data.error || 'Unknown error'));
                }
            } catch (err) {
                alert('Error: ' + err.message);
            }
        }
        
        // Stop bot
        async function stopBot() {
            try {
                const res = await fetch('/api/bot/stop', { method: 'POST' });
                const data = await res.json();
                if (data.success) {
                    console.log('Bot stopped');
                } else {
                    alert('Failed to stop: ' + (data.error || 'Unknown error'));
                }
            } catch (err) {
                alert('Error: ' + err.message);
            }
        }
        
        // Initialize
        fetchData();
        setInterval(fetchData, 2000);  // Update every 2 seconds
    </script>
</body>
</html>
